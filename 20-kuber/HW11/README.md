# Домашнее задание к занятию "`Компоненты Kubernetes`" - `Гущин Евгений`

### Задание. Необходимо определить требуемые ресурсы

Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

1. Необходимо упаковать приложение в чарт для деплоя в разные окружения.
2. База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
3. Кеш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
4. Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий.
5. Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

### Решение

1. Для обеспечения отказоустойчивости развернем проект на 3 нодах.

2. Базу распределим на 3 ноды по одной копии на каждой

3. Кеш распределим на 3 ноды по одной копии на каждой

4. Фронетенд распределим по нодам в следующей последовательности:
- 1 нода : 2 копии
- 2 нода : 2 копии
- 3 нода : 1 копия

5. Бекенд распределим по нодам в следующей последовательности:
- 1 нода : 4 копии
- 2 нода : 3 копии
- 3 нода : 3 копии

6. Системные требования к одной ноде:
- Ядра : 4 (по максимуму бекенда)
- ОЗУ : Берем с запасом 30 % (4Гб + 4Гб + 50Мб * 2 + 600Мб * 4) * 1,3 = (8Гб + 2500Мб) * 1,3 = 13,6Гб
- HDD : 30Гб должно хватить на разворачивание кластера, но нет информации о размере БД (возможно надо увеличить)

Также если верить статистике, различные сервисы ноды microk8s потребляют около 1Гб ОЗУ

Итого ресурсы для одной ноды:

```
Процессор : 4 ядра
ОЗУ 	  : 15Гб		
HDD		  : 30Гб
```

7. В случае выхода из строя одной ноды ее нагрузку надо распределить на оставшиеся, тогда требования будут следующие:

```
Процессор : 6 ядер
ОЗУ 	  : 22,5Гб		
HDD		  : 45Гб
```

Также возможно, что потребление ресурсов системными службами может вырасти, поэтому заложим дополнительный запас. Итого на одну ноду потребуется:

```
Процессор : 7 ядер
ОЗУ 	  : 25Гб		
HDD		  : 50Гб
```

Всего ресурсов:

```
Процессор : 21 ядро
ОЗУ 	  : 75Гб		
HDD		  : 150Гб
```
